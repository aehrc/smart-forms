services:
  # Smart-Forms-App
  # Runtime Configuration: Mount your custom config.json to override defaults.
  # See config.docker.json for an example configuration file.

  smart-forms-app:
    image: aehrc/smart-forms-app:latest
    build:
      context: ./
      dockerfile: Dockerfile
    container_name: smart-forms-app
    ports:
      - "80:80"
    volumes:
      # Mount custom config.json for runtime configuration
      # Uncomment and modify the path to use your own config:
      # - ./config.docker.json:/usr/share/nginx/html/config.json:ro
      - ./config.docker.json:/usr/share/nginx/html/config.json:ro
    restart: unless-stopped

  # Development mode service (optional)
  # Uncomment this section if you need development mode with hot reloading
  # smart-forms-app-dev:
  #   image: node:20
  #   container_name: smart-forms-app-dev
  #   working_dir: /app
  #   ports:
  #     - "5173:5173"
  #     - "6006:6006"
  #   volumes:
  #     - ./:/app
  #     - /app/node_modules
  #     - /app/apps/smart-forms-app/node_modules
  #     - /app/apps/smart-forms-app/dist
  #     - /app/packages/smart-forms-renderer/node_modules
  #     - /app/packages/smart-forms-renderer/lib
  #     - /app/packages/sdc-assemble/node_modules
  #     - /app/packages/sdc-assemble/lib
  #     - /app/packages/sdc-populate/node_modules
  #     - /app/packages/sdc-populate/lib
  #   command: >
  #     sh -c "
  #       cd /app/packages/smart-forms-renderer && npm run storybook-watch &
  #       P1=$!
  #       cd /app/apps/smart-forms-app/ && rm -rf node_modules/.vite && npm start -- --host 0.0.0.0 &
  #       P2=$!
  #       wait $P1 $P2
  #     "
