{
  "resourceType": "Questionnaire",
  "id": "715AssessmentMedicalHistory",
  "meta": {
    "profile": [
      "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-render",
      "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-modular"
    ]
  },
  "url": "http://www.health.gov.au/assessments/mbs/715/715AssessmentMedicalHistory",
  "extension": [
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-assemble-expectation",
      "valueCode": "assemble-child"
    },
    {
      "extension": [
        {
          "url": "name",
          "valueCoding": {
            "code": "patient",
            "system": "http://hl7.org/fhir/uv/sdc/CodeSystem/launchContext"
          }
        },
        {
          "url": "type",
          "valueCode": "Patient"
        },
        {
          "url": "description",
          "valueString": "The patient that is to be used to pre-populate the form"
        }
      ],
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-launchContext"
    },
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-sourceQueries",
      "valueReference": {
        "reference": "#PrePopQuery"
      }
    }
  ],
  "item": [
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "code": "tab",
                "system": "https://aehrc.csiro.au/fhir/CodeSystem/QuestionnaireItemControlExtended"
              }
            ]
          }
        }
      ],
      "item": [
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-unit",
              "valueCoding": {
                "code": "wk",
                "system": "http://unitsofmeasure.org"
              }
            }
          ],
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "unit",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                }
              ],
              "linkId": "f3899852-36c4-441f-9a7d-544ef1617f08",
              "text": "weeks",
              "type": "display"
            }
          ],
          "linkId": "a10a7375-e9d3-4e71-a47a-282e9ba38ec1",
          "text": "Gestation at birth",
          "type": "decimal",
          "repeats": false,
          "enableWhen": [
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": "<=",
              "answerInteger": 5
            }
          ]
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-unit",
              "valueCoding": {
                "code": "kg",
                "system": "http://unitsofmeasure.org"
              }
            }
          ],
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "unit",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                }
              ],
              "linkId": "87cf1ecd-6d1b-4de1-894d-58bd77dcfde1",
              "text": "kg",
              "type": "display"
            }
          ],
          "linkId": "29b6d8ea-23b2-4a69-98d9-899198692de7",
          "text": "Birth weight",
          "type": "decimal",
          "repeats": false,
          "enableWhen": [
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": "<=",
              "answerInteger": 5
            }
          ]
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "check-box",
                    "system": "http://hl7.org/fhir/questionnaire-item-control"
                  }
                ]
              }
            }
          ],
          "linkId": "033db7b3-80da-43e2-9838-88f3d51e5913",
          "text": "Problems",
          "type": "choice",
          "repeats": true,
          "enableWhen": [
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": "<=",
              "answerInteger": 5
            }
          ],
          "answerValueSet": "#MedicalHistoryShortListInfants"
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "check-box",
                    "system": "http://hl7.org/fhir/questionnaire-item-control"
                  }
                ]
              }
            }
          ],
          "linkId": "384ab440-10ed-4ac1-89da-cd7d24f87a95",
          "text": "Problems",
          "type": "choice",
          "repeats": true,
          "enableWhen": [
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": ">",
              "answerInteger": 5
            },
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": "<=",
              "answerInteger": 12
            }
          ],
          "enableBehavior": "all",
          "answerValueSet": "#MedicalHistoryShortListPrimarySchool"
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "check-box",
                    "system": "http://hl7.org/fhir/questionnaire-item-control"
                  }
                ]
              }
            }
          ],
          "linkId": "c24ae0d2-8932-4b87-9b7e-a644b5eb2874",
          "text": "Problems",
          "type": "choice",
          "repeats": true,
          "enableWhen": [
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": ">",
              "answerInteger": 12
            },
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": "<=",
              "answerInteger": 24
            }
          ],
          "enableBehavior": "all",
          "answerValueSet": "#MedicalHistoryShortListAdolescents"
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "check-box",
                    "system": "http://hl7.org/fhir/questionnaire-item-control"
                  }
                ]
              }
            }
          ],
          "linkId": "bba27ef5-05c5-4e9c-bc9f-cf42091e99cb",
          "text": "Problems",
          "type": "choice",
          "repeats": true,
          "enableWhen": [
            {
              "question": "e2a16e4d-2765-4b61-b286-82cfc6356b30",
              "operator": ">",
              "answerInteger": 24
            }
          ],
          "answerValueSet": "#MedicalHistoryShortListAdultsAndOlderPeople"
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "autocomplete",
                    "system": "http://hl7.org/fhir/questionnaire-item-control"
                  }
                ]
              }
            },
            {
              "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression",
              "valueExpression": {
                "language": "text/fhirpath",
                "expression": "%PrePopQuery.entry[21].resource.entry.resource.code.select((coding.where(system='http://snomed.info/sct') | coding.where(system!='http://snomed.info/sct').first() | text ).first())"
              }
            },
            {
              "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-shortText",
              "valueString": "Other relevant medical history"
            }
          ],
          "linkId": "736f2a51-e04d-4e7f-aef1-c47f3a1f4e3c",
          "text": "Other relevant medical history, operations, hospital admissions, etc",
          "type": "open-choice",
          "repeats": true,
          "answerValueSet": "https://aehrc.csiro.au/fhir/ValueSet/MedicalHistory"
        },
        {
          "linkId": "f00def30-35dd-401a-9a38-12602bd3b8b1",
          "text": "Provide details of identified problems",
          "type": "text",
          "repeats": false
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "code": "gtable",
                    "system": "http://hl7.org/fhir/questionnaire-item-control"
                  }
                ]
              }
            }
          ],
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "autocomplete",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                },
                {
                  "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression",
                  "valueExpression": {
                    "language": "text/fhirpath",
                    "expression": "%PrePopQuery.entry[21].resource.entry.resource.code.select((coding.where(system='http://snomed.info/sct') | coding.where(system!='http://snomed.info/sct').first() | text ).first())"
                  }
                }
              ],
              "linkId": "59b1900a-4f85-4a8c-b9cd-3fe2fd76f27e",
              "text": "Condition",
              "type": "open-choice",
              "answerValueSet": "https://aehrc.csiro.au/fhir/ValueSet/MedicalHistory"
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "drop-down",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                },
                {
                  "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression",
                  "valueExpression": {
                    "language": "text/fhirpath",
                    "expression": "%PrePopQuery.entry[21].resource.entry.resource.clinicalStatus.coding.code"
                  }
                }
              ],
              "linkId": "88bcfad7-386b-4d87-b34b-2e50482e4d2c",
              "text": "Clinical Status",
              "type": "choice",
              "answerValueSet": "#condition-clinical"
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "autocomplete",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                },
                {
                  "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression",
                  "valueExpression": {
                    "language": "text/fhirpath",
                    "expression": "%PrePopQuery.entry[21].resource.entry.resource.onsetDateTime"
                  }
                }
              ],
              "linkId": "6ae641ad-95bb-4cdc-8910-5a52077e492c",
              "text": "Onset Date",
              "type": "dateTime"
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "code": "autocomplete",
                        "system": "http://hl7.org/fhir/questionnaire-item-control"
                      }
                    ]
                  }
                },
                {
                  "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-initialExpression",
                  "valueExpression": {
                    "language": "text/fhirpath",
                    "expression": "%PrePopQuery.entry[21].resource.entry.resource.recordedDate"
                  }
                }
              ],
              "linkId": "18b9e159-2ed7-4047-82b7-deb2a171de4f",
              "text": "Recorded Date",
              "type": "dateTime"
            }
          ],
          "linkId": "92bd7d05-9b5e-4cf9-900b-703f361dad9d",
          "text": "Medical history and current problems list",
          "type": "group",
          "repeats": true
        },
        {
          "linkId": "62774152-8a6e-4449-af9f-87bdce8b9bf5",
          "text": "Health priorities, actions and follow-up",
          "type": "text",
          "repeats": false
        }
      ],
      "linkId": "28d5dbe4-1e65-487c-847a-847f544a6a91",
      "text": "Medical history and current problems",
      "type": "group",
      "repeats": false
    }
  ],
  "contained": [
    {
      "resourceType": "Bundle",
      "id": "PrePopQuery",
      "type": "batch",
      "entry": [
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52553",
          "request": {
            "method": "GET",
            "url": "FamilyMemberHistory?patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52554",
          "request": {
            "method": "GET",
            "url": "Observation?code=72166-2&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52555",
          "request": {
            "method": "GET",
            "url": "Observation?code=8302-2&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52556",
          "request": {
            "method": "GET",
            "url": "Observation?code=8280-0&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52557",
          "request": {
            "method": "GET",
            "url": "Observation?code=29463-7&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52558",
          "request": {
            "method": "GET",
            "url": "Observation?code=8867-4&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52559",
          "request": {
            "method": "GET",
            "url": "Observation?code=39156-5&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52560",
          "request": {
            "method": "GET",
            "url": "Observation?code=85354-9&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52561",
          "request": {
            "method": "GET",
            "url": "Observation?code=72166-2&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52562",
          "request": {
            "method": "GET",
            "url": "Observation?code=160625004&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52563",
          "request": {
            "method": "GET",
            "url": "Observation?code=smoking-date-started&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52564",
          "request": {
            "method": "GET",
            "url": "Observation?code=229819007&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52565",
          "request": {
            "method": "GET",
            "url": "Observation?code=160573003&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52566",
          "request": {
            "method": "GET",
            "url": "Observation?code=228308009&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52567",
          "request": {
            "method": "GET",
            "url": "Observation?code=1373041000168105&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52568",
          "request": {
            "method": "GET",
            "url": "Observation?code=160573003&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52569",
          "request": {
            "method": "GET",
            "url": "Observation?code=60621009&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52570",
          "request": {
            "method": "GET",
            "url": "Observation?code=absolute-cvd-risk&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52571",
          "request": {
            "method": "GET",
            "url": "Immunization?patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52572",
          "request": {
            "method": "GET",
            "url": "MedicationStatement?patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52573",
          "request": {
            "method": "GET",
            "url": "AllergyIntolerance?patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52575",
          "request": {
            "method": "GET",
            "url": "Condition?patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52574",
          "request": {
            "method": "GET",
            "url": "DiagnosticReport?patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52576",
          "request": {
            "method": "GET",
            "url": "Observation?code=14647-2&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:38a25157-b8e4-42e4-9525-7954fed52577",
          "request": {
            "method": "GET",
            "url": "Observation?code=14646-4&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        },
        {
          "fullUrl": "urn:uuid:12f24514-437e-40d8-b5c3-bfe8ecb4995d",
          "request": {
            "method": "GET",
            "url": "Observation?code=9843-4&_count=1&_sort=-date&patient={{%patient.id}}"
          }
        }
      ]
    }
  ],
  "name": "715AssessmentMedicalHistory",
  "title": "715 Assessment Medical History",
  "status": "draft",
  "experimental": true,
  "subjectType": ["Patient"],
  "date": "2022-05-24",
  "jurisdiction": [
    {
      "coding": [
        {
          "code": "AU",
          "system": "urn:iso:std:iso:3166"
        }
      ]
    }
  ]
}
